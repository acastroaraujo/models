{
  "hash": "dc48f51155e2a22b812177ea13b7a5bc",
  "result": {
    "markdown": "---\ntitle: \"ERGMs\"\n---\n\n\n## Exponential Random Graph Models\n\n> The purpose of ERGMs, in a nutshell, is to describe parsimoniously the local selection forces that shape the global structure of a network.\n>\n> @hunter2008 [pp. 2]\n\nExponential Random Graphs Models attempt to predict the ties in a network---i.e., it describes tie-formation processes. An ERGM takes the entire observed network as one instance of a probability distribution for all possible networks with the same number of nodes, including the completely empty network (no ties) and the completely connected network (every node is connected to every other node).\n\n<aside>ERGMs are also known as p-star models.</aside>\n\n*Notation.*\n\nA network is represented as an adjacency matrix $\\mathbf Y$ which is also a random variable; $y$ is a specific *realization* of that variable---i.e., the network we actually get to observe.\n\n$$\ny_{ij} = \\begin{cases}\n1 & \\text{if } i \\text{ sends a tie to } j \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n\n<aside>$y_{ij} = y_{ji}$ when $\\mathbf Y$ is undirected</aside>\n\nThe ERGM specifies the probability of a set of ties $\\Pr(\\mathbf Y = y)$ given a set of persons and their attributes. More importantly, we posit that this probability depends on the number of certain *configurations* of ties which reflect particular social processes (e.g., reciprocity, transitivity, homophily). Some of these processes assume *dyadic independence* (e.g., homophily) and some assume *dyadic dependence,* which the likelihood of a dyad $y_{ij}$ is dependent on the existence of other dyads*;* for example, transitivity implies that if $y_{ij}$ and $y_{jk}$ both exist, then $y_{ki}$ is more likely to exist. These processes are represented with a vector $\\boldsymbol z$ of *network statistics.*\n\n<aside>Tie-formation mechanisms are context-dependent---e.g., friendship networks are marked by reciprocity and homophily; patronage networks are expected to be asymmetric, non-transitive, and heterophilous; scientific citations are marked by preferential attachment; etc.</aside>\n\nFor example, the number of reciprocal ties *(reciprocity)* can be quantified as follows:\n\n$$\n\\boldsymbol z_r(\\mathbf Y) = \\sum_{i < j} \\mathbf{Y}_{ij} \\times \\mathbf{Y}_{ji}\n$$\n\n<aside>reciprocity example</aside>\n\nSee @morris2008 for a list of widely used network statistics and other covariates implemented in the `ergm` package.\n\n**ERGMs**\n\nThe probability distribution of a random graph can be parameterized as follows:\n\n$$\n\\begin{align}\n\\Pr(\\mathbf Y = y)  &= \\frac{1}{\\kappa (\\boldsymbol \\theta)} \\exp \\bigg(\\sum_{k=1}^K \\theta_k z_k(y)\\bigg) \\\\\\\\\n&= \\frac{1}{\\kappa (\\boldsymbol \\theta)} \\exp \\Big( \n\\boldsymbol \\theta^\\top \\boldsymbol z(y) \\Big)\n\\end{align}\n$$ {#eq-1}\n\n<aside>\n\nThe normalizing constant can be expressed as follows:\n\n$$\n\\kappa(\\boldsymbol \\theta) = \\sum_{y \\in \\mathcal N} \\exp \\Big(\\boldsymbol \\theta^\\top \\boldsymbol z(y) \\Big),\n$$\n\nwhere $\\mathcal N$ is the support of $\\mathbf Y$---i.e., the set of all potential networks realizable by $\\mathbf Y$.\n\n</aside>\n\nThe $\\boldsymbol{z}(y)$ vector represents covariates and the $\\boldsymbol \\theta$ vector represents coefficients to be estimated. This vector can be expanded by replacing $\\boldsymbol{z}(y)$ with $\\boldsymbol{z}(y, \\mathbf{X})$ to allow for additional covariate information about the network.\n\nThe denominator $\\kappa$ represents the quantity in the numerator summed over all possible networks of the same size. Specifing this number is an important yet often overlooked aspect of an ERGM. Furthermore, the set of all possible networks $\\mathcal N$ tends to be very big and so it is usually unfeasible to compute $\\kappa$ directly; hence, these models are usually fit using some approximation method (like MCMC) instead of more traditional maximum likelihood estimation.\n\nOnce we have a vector $\\boldsymbol \\theta$ of parameters, ERGMs can be used to *generate* new networks. Thus, we can then study the types of networks produced, on average, by the tie-formation processes incorporated in an ERGM.\n\n**Change statistics**\n\nAn alternative specification of @eq-1 may clarify the interpretation of the coefficients in $\\boldsymbol \\theta$. A vector of *change statistics* $\\boldsymbol \\delta$is a function of three things: (1) a particular choice of $\\boldsymbol z$ statistics defined on a network; (2) a particular network $y$; and (3) a particular collection of dyad indices $(i, j)$. With this in place, we define a vector of change statistics as follows:\n\n$$\n\\boldsymbol{\\delta_{z}}(y)_{ij} = \\boldsymbol{z}(y_{ij}^+) - \\boldsymbol{z}(y_{ij}^-)\n$$\n\nHere, $y_{ij}^+$ and $y_{ij}^-$ represent the networks realized respectively by fixing $y_{ij} = 1$ and $y_{ij} = 0$ while keeping the rest of the network exactly as in $y$. Thus, $\\boldsymbol{\\delta_z}(y)_{ij}$ is the change in the value of the network statistic vector $\\boldsymbol z$ that would occur if $y_{ij}$ where changed from $0$ to $1$.\n\n**ERGMs as logistic regression**\n\n@eq-1 can be expressed, with the help of the change statistic vector, as a logistic regression for dyads:\n\n$$\n\\begin{align}\n\\Pr(Y_{ij} = 1 \\mid \\mathbf{Y}_{ij}^c = y_{ij}^c) &= \\text{logit}^{-1} \\Bigg( \n\\sum_{k = 1}^K \\theta_k \\delta_{\\boldsymbol{z}_k}(y)_{ij} \\Bigg) \\\\\\\\ &=\n\\text{logit}^{-1} \\Big( \\boldsymbol \\theta^\\top \\boldsymbol{\\delta_z}(y)_{ij}\n\\Big)\n\\end{align}\n$$ {#eq-2}\n\nHere, $Y_{ij}^c$ denotes all dyads *other* than $Y_{ij}$ and $\\delta z_k (y)$ is the amount by which $z_k(y)$ changes when $Y_{ij}$ is toggled from 0 to 1. The presence of $Y_{ij}^c$ in the conditional reflects the mutual dependence of ties. This clarifies the interpretation of $\\boldsymbol \\theta$---i.e., if forming a tie increases $z_k$ by 1 then *(all else equal)* the log-odds of that tie forming increase by $\\theta_k$. *Note that a single tie may affect multiple* $z$ *statistics.*\n\n## Assumptions\n\n> **The homogeneity assumption.** In its most general form, this model could include $d â€“ 1$ terms, where $d$ is the number of dyads in the network. That would be a saturated model with every tie having its own probability. As in any statistical model, the goal is to find a parsimonious representation, and proposing homogeneous classes of dyads is a common form of parsimony. Any $z$ statistic counting the aggregate number of some configuration (e.g., triangles) makes an implicit *homogeneity* assumption, that is, that all counted instances are equiprobable. This is similar to the assumption in linear regression that a covariate's effect is the same for all observations...\n>\n> **Dyadic dependence and independence.** When a model includes only terms that represent the composition of node attributes within ties, it is similar to traditional logistic or log-linear models for contingency tables (Koehly, Goodreau, and Morris 2004). Such models are said to exhibit dyadic independence because the probability of any tie does not depend on the value of other ties, only on the attributes of the two actors involved. As a result, $Y^c_{ij}$ can be removed from the conditional in @eq-2, yielding a set of independent observations amenable to standard statistical analysis.\n>\n> \\[...\\]\n>\n> **Estimation and model degeneracy.**\n>\n> Given a proposed model (set of $z$ statistics), one would like to identify the $\\boldsymbol \\theta$ vector maximizing model likelihood. However, the normalizing constant $c$ in @eq-1 is impossible to calculate for all but the smallest networks, preventing direct evaluation of the likelihood function...\n>\n> The likelihood can be approximated using Markov chain Monte Carlo simulation methods (MCMC; Geyer and Thompson 1992; Snijders 2002), which generate a sample from the space of possible networks to estimate the $\\boldsymbol \\theta$ vector. This approach has additional benefits: the same algorithm may be used to simulate network realizations for a given $\\boldsymbol \\theta$ vector with appropriate probability. A sample of such realizations provides a means for examining model fit (Hunter, Goodreau, and Handcock 2008).\n>\n> This behavior, termed *model degeneracy*, was explored in detail by Handcock (2003a, 2003b). The intuition behind degeneracy is relatively straightforward. If we specify a model that is unlikely to produce the observed network, then one of two things can happen when it is fit to data: either the MLEs do not exist and estimation does not converge (as in the extremal case above), or the MLEs exist but do not provide a good fit to the data (as in the bimodal case above). Degeneracy is not a shortcoming of the MCMC estimation procedure; nor does it necessarily imply that our intuition about the general process (e.g., that triangles tend to become closed) is wrong. It just implies that the process is not properly specified (e.g., that closure occurs homogeneously across all actor pairs). The solution is to specify a better-fitting model for the data, but this is less straightforward for networks than for other statistical contexts. In ERG modeling, a misspecified model can fail to converge, yielding no parameter estimates to guide model diagnosis or respecification.\n>\n> Many of the potential solutions to degeneracy replace strong homogeneity assumptions with some form of heterogeneity that defines the scope or form of dependence. One plausible feature of the triad closure case may be a differential tendency for triad closure by attribute combinations---for example, that only triads comprising three actors with shared attributes tend to close. Another mechanism entails a decreasing marginal impact in the effect of triangles on tie formation. To capture this phenomenon, Hunter (2007) and Hunter and Handcock (2006) described a statistic called the *geometrically weighted edgewise shared partner distribution* (GWESP), a reparameterization of a statistic of Snijders et al. (2006). The shared partner distribution is an alternative approach to counting triangles. Two actors \"share\" a partner if both have a tie to the same partner, and each shared partner forms a triangle if the original pair are tied. In contrast to the census of triangles or the clustering coefficient (which produce a single measure for the whole network), the shared partner count is taken on each edge (hence the \"edgewise\"), producing a distribution of counts. The GWESP statistic defines a parametric form of this count distribution that gives each additional shared partner a declining positive impact on the probability of two persons forming a tie. This approach has a clear interpretation and has been shown to work well in practice in overcoming model degeneracy and producing models that fit a wide range of data well...\n>\n> @goodreau2009 [pp. 109-11]\n\nMore references: @hunter2008; @mcfarland2014; @wimmer2010; @krivitsky2017; @smith2012; @goodreau2009; @robins2007a; @robins2007b; @krivitsky2019\n\n*Why can't we just turn our adjacency matrix into long-form so that the unit of observation is a dyad and then predict the presence of ties using logistic regression?*\n\n> ...the number of observations in such dyadic datasets are much larger than the number of individuals, because each individual appears (*nxn*)-*n* times as a possible outcome of every other individual's choice set and as the possible chooser of every other individual. Consequently, standard errors will be biased downward as the sample size is artificially inflated, and correlated errors are introduced through repeated observations of individuals as both senders and receivers of ties.\n\n## Examples\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ergm)\n```\n:::\n\n\nhttps://statnet.org/workshop-ergm/ergm_tutorial.html\n\nhttps://bookdown.org/markhoff/social_network_analysis/homophily-and-exponential-random-graphs-ergm.html\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}